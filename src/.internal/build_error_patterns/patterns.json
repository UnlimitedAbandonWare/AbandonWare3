{
  "version": "1.0",
  "captured_at": "now",
  "patterns": [
    {
      "id": "MISSING_IMPORT__SERVICE_BACKUP",
      "match": {
        "contains": [
          "cannot find symbol",
          "ChatService__backup_pre_interface.java",
          "QueryTransformer",
          "QueryCorrectionService"
        ]
      },
      "fix": [
        "Add import com.example.lms.transform.QueryTransformer;",
        "Add import com.example.lms.service.correction.QueryCorrectionService;",
        "Ensure import org.springframework.beans.factory.annotation.Qualifier;"
      ]
    },
    {
      "id": "LOMBOK_BUILDER_DEFAULT_WITHOUT_BUILDER",
      "severity": "warning",
      "hint": "Add @Builder or remove @Builder.Default on classes using it."
    },
    {
      "id": "fix-missing-findbugs-annotations-and-lombok",
      "title": "Add FindBugs annotations (compileOnly) and Lombok (compileOnly+annotationProcessor)",
      "severity": "blocker",
      "match_any": [
        "(package\\s+edu\\.umd\\.cs\\.findbugs\\.annotations\\s+does\\s+not\\s+exist)",
        "(package\\s+lombok\\s+does\\s+not\\s+exist|cannot\\s+find\\s+symbol\\s+@\\w+\\s*builder|\\bLombok\\b)"
      ],
      "actions": [
        {
          "type": "patch_gradle",
          "targets": [
            "**/build.gradle",
            "**/build.gradle.kts"
          ],
          "inject": {
            "groovy": [
              "compileOnly 'org.projectlombok:lombok:1.18.34'",
              "annotationProcessor 'org.projectlombok:lombok:1.18.34'",
              "testCompileOnly 'org.projectlombok:lombok:1.18.34'",
              "testAnnotationProcessor 'org.projectlombok:lombok:1.18.34'",
              "compileOnly 'com.google.code.findbugs:annotations:3.0.1'"
            ],
            "kts": [
              "compileOnly(\"org.projectlombok:lombok:1.18.34\")",
              "annotationProcessor(\"org.projectlombok:lombok:1.18.34\")",
              "testCompileOnly(\"org.projectlombok:lombok:1.18.34\")",
              "testAnnotationProcessor(\"org.projectlombok:lombok:1.18.34\")",
              "compileOnly(\"com.google.code.findbugs:annotations:3.0.1\")"
            ]
          }
        }
      ],
      "notes": "Mitigates : missing FindBugs annotations; ensures Lombok processing is enabled."
    },
    {
      "id": "MAIN_CLASS_NOT_FOUND_bootRun",
      "title": "Spring Boot main class not found / bootRun",
      "severity": "blocker",
      "match_any": [
        "Error: Could not find or load main class",
        "java.lang.ClassNotFoundException: com.example.lms.LmsApplication"
      ],
      "suggest": [
        "Create @SpringBootApplication class: com.example.lms.LmsApplication",
        "Set springBoot.mainClass to com.example.lms.LmsApplication",
        "Use Java toolchain 17 for compatibility with runtime"
      ],
      "kts_fixes": [
        "springBoot { mainClass.set(\"com.example.lms.LmsApplication\") }",
        "tasks.withType<org.springframework.boot.gradle.tasks.bundling.BootJar> { mainClass.set(\"com.example.lms.LmsApplication\") }"
      ],
      "actions": [
        "./gradlew :app:clean :app:bootJar",
        "./gradlew :app:bootRun --no-daemon"
      ],
      "notes": "Pattern added by src111_merge15 patch to eliminate bootRun main-class failures and  leakage."
    },
    {
      "id": "STRIP_STUFF3_DISABLED_MARKER",
      "match": {
        "contains_any": [
          "STUFF3_DISABLED",
          "STUFF3_DISABLED",
          "STUFF3_DISABLED"
        ]
      },
      "action": {
        "type": "sanitize",
        "strategy": "strip_marker"
      },
      "notes": "Strip non-fatal STUFF3_DISABLED/STUFF3_DISABLED placeholders at guard stage."
    },
    {
      "id": "MISSING_CLASS_DPP",
      "match": {
        "contains_all": [
          "cannot find symbol",
          "class DppDiversityReranker"
        ]
      },
      "fix": [
        "Create com.example.lms.service.rag.rerank.DppDiversityReranker with Config(lambda,k) and rerank(List, String, int).",
        "Fix FQCN in UnifiedRagOrchestrator: com.example.lms.service.rag.rerank.DppDiversityReranker"
      ],
      "notes": "Auto-suggest creation of the missing reranker and package path typo."
    },
    {
      "id": "TREE_SERIALIZER_ESCAPE",
      "match": {
        "contains_any": [
          "TreeSerializer.java",
          "illegal character",
          "unclosed string literal"
        ]
      },
      "fix": [
        "Use escape for quotes: s.replace(\"\\\"\", \"\\\\\\\"\") and replace newlines to space."
      ]
    }
  ]
}