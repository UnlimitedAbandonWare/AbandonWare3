# application.properties.example — sanitized for commit
# Real values must be provided via environment variables (see placeholders).
#?? ? --spring.profiles.active=ultra ? ???.
spring.profiles.active=ultra

# LLM (Groq ??) ? ???? ?/?????/?? ??
llm.provider=groq
llm.base-url=https://api.groq.com/openai/v1
llm.api-key=${LLM_API_KEY}
llm.chat-model=llama-3.1-8b-instant
llm.chat.temperature=0.2

# --------------------------------------------------------------------------
# Disable LangChain4j auto-configuration.  Manual builders are used instead.
spring.autoconfigure.exclude=\
+spring.autoconfigure.exclude=dev.langchain4j.spring.AiAutoConfiguration,dev.langchain4j.spring.autoconfigure.LangChain4jAutoConfiguration,dev.langchain4j.service.spring.AiServicesAutoConfiguration,dev.langchain4j.model.openai.spring.autoconfigure.OpenAiAutoConfiguration
# === [ADD] From {???1} ===
agent.knowledge-curation.enabled=true
# application.properties ? ??? ?? ?? ??
memory.read.enabled=true
memory.write.enabled=true
orchestrator.energy.enabled=true
# === [ADD] Gemini (from {???1})
gemini.backend=developer
gemini.project.id=${GCP_PROJECT:}
gemini.location=${GCP_LOCATION:global}
gemini.curator.model=gemini-2.5-pro
gemini.batch.model=gemini-2.0-flash
gemini.timeouts.connect-ms=2000
gemini.timeouts.read-ms=15000
# === [CHANGE] Gemini API key (prefer GOOGLE_API_KEY; fallback GEMINI_API_KEY)
gemini.api.key=AIzaSyBV12Cic-fO4Dd8bNwttknxKF5ov3iaff0
# === [ADD] Router MOE (from {???1})
router.moe.learning-intents=CURATION,RULE_INDUCTION,KB_UPDATE,ANALYSIS
reinforce.step=0.02
# (??)
local-llm.enabled=false
# When local-llm is enabled the chat model will route through an OpenAI compatible endpoint.
# Provide a base URL via OPENAI_COMPAT_BASE_URL or fall back to the Groq endpoint.
local-llm.base-url=${OPENAI_COMPAT_BASE_URL:https://api.groq.com/openai/v1}
strategy.temperature=1.0
strategy.epsilon=0.10

energy.w.rel=0.6, energy.w.auth=0.2, energy.w.rec=0.1, energy.w.red=0.6, energy.w.ctr=0.8

memory.reinforce.pruning.llm.enabled=false

verifier.evidence.min-count.memory=1
# ??/?? ??
memory.read.max-turns=8
memory.evidence.max-turns=6

# ?? ??
verifier.evidence.min-count=2
verifier.evidence.min-count.followup=1

# ClaimVerifier SOFT-FAIL ?? ?? (?? ? ???? ?? ??)
verifier.claim.softfail.whenNoContext=true

# ??? ?? ???(??/??/??)
search.preferred.domains=*.ac.kr,*.go.kr,*.or.kr

# ????? ?? ? ??(Fusion) ??
# === [ADD] Answer detail ?? ???(Verbosity?) ===
# === [ADD] From {???1} ===
# Answer ?? ???(Verbosity?)
abandonware.answer.detail.min-words.brief=120
abandonware.answer.detail.min-words.standard=250
abandonware.answer.detail.min-words.deep=600
abandonware.answer.detail.min-words.ultra=1000



# Orchestrator ?? ??(??+Verbosity?)
orchestrator.max-docs=10
orchestrator.max-docs.deep=14
orchestrator.max-docs.ultra=18

# Reranker ?? N ??(Verbosity?)
reranker.keep-top-n.brief=5
reranker.keep-top-n.standard=8
reranker.keep-top-n.deep=12
reranker.keep-top-n.ultra=16


# === [ADD] Answer ?? ?? ??(Verbosity?) ===
abandonware.answer.token-out.brief=512
abandonware.answer.token-out.standard=1024
abandonware.answer.token-out.deep=2048
abandonware.answer.token-out.ultra=3072





hybrid.max-parallel=2
selfask.use-llm-followups=false
# [ADD] ??/?? ??? ?? (?? ? ??? ?? ??, ?? ?? ??)
logging.charset.console=UTF-8
logging.charset.file=UTF-8

# [ADD] ??/?? ? URI ??? ?? (Tomcat)
server.servlet.encoding.enabled=true
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.force=true
server.tomcat.uri-encoding=UTF-8

# -----------------------------------------------------------------------------
# Image generation plugin configuration.  These properties control where
# generated images are persisted and how the asynchronous image job queue
# operates.  The relay delay determines the cadence at which pending
# image jobs are processed (in milliseconds) and eta-samples defines
# how many recent job durations are included in the moving average ETA
# calculation.  On Windows escaping backslashes in the root path is
# required.
## [Image storage & jobs]
image.storage.root=G:\\? ????\\img
image.storage.public-prefix=/generated-images/
image.jobs.relay-delay-ms=300000
image.jobs.eta-samples=10
############################################################
logging.level.org.springframework=INFO
logging.level.org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider=INFO
logging.level.org.springframework.context.annotation.ClassPathBeanDefinitionScanner=INFO

# 0. ??? ?? ??
############################################################
spring.main.allow-bean-definition-overriding=true
debug=false
spring.main.log-startup-info=false
# ??? ??? ?? ???
energy.weight.confidence=0.20
energy.weight.recency=0.15
energy.recency.tauHours=72.0

# ?? ???(Simulated Annealing) ??
anneal.mode=sqrt
anneal.t0=1.0
# =================================================
# Memory Snippet Settings
# =================================================
# ??? ?? ? ???? ??/?? ?? ??
memory.snippet.min-length=40
memory.snippet.max-length=4000

############################################################
# 1. ?????? & HikariCP
############################################################
spring.datasource.url=jdbc:mariadb://localhost:3306/lmsdb?useUnicode=true&characterEncoding=utf8mb4&connectionCollation=utf8mb4_unicode_ci
spring.datasource.username=root
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
spring.datasource.driver-class-name=org.mariadb.jdbc.Driver

spring.datasource.hikari.maximum-pool-size=15
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=45000
spring.datasource.hikari.connection-init-sql=SET NAMES utf8mb4
# ?? assistant ??? DB ?? ??
history.skip-weak-assistant=true

# ?? ?? ??? ?? ?? (?? true)
guard.evidence_regen.enabled=true


# LangChain4j 1.0.1 ??? ??(?? build.gradle? ??): ?? ?? ??
# (?? ??? ????, properties ???? ??? ?-? ?? ?? ????? ?????.)

############################################################
# 2. JPA / Hibernate
############################################################
spring.jpa.database-platform=org.hibernate.dialect.MariaDBDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.connection.characterEncoding=utf8mb4
spring.jpa.properties.hibernate.connection.CharSet=utf8mb4
spring.jpa.properties.hibernate.connection.useUnicode=true

# AUTOCOMMIT ???? ??
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true

# SQLBIND ???? ?? ????
spring.jpa.show-sql=true
# Naver API & ??(Hedging) ??


# Self-Ask Retriever ?? (API ??? ??)

# NEW: Self?Ask ????(??/??)
selfask.timeout-seconds=10
selfask.per-request-timeout-ms=5000

# (??) Tavily ?? ? ?? ? true? ????? API ? ??
tavily.enabled=true
tavily.api.url=https://api.tavily.com/search
tavily.api.key=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
tavily.max-results=5
tavily.timeout-ms=3000

############################################################
# 3. ?? ??
############################################################
# 3-1. ?? ?? ??
logging.file.name=logs/lms-app.log
logging.file.max-size=10MB
logging.file.total-size-cap=100MB

# 3-2. ?? (Caffeine)
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=5000,expireAfterAccess=10m

# 3-3. ???? ????
spring.transaction.default-timeout=30s
# PAIRING ??
abandonware.policy.pairing.min-evidence=2
abandonware.policy.pairing.trusted-hosts=namu.wiki,www.hoyolab.com,genshin.hoyoverse.com,hoyolab.com

# ?? ???
# [MOE] ?????? ?? — overridden below.  LangChain4j auto-config is disabled.
# Use GPT‑5 mini for LangChain4j chat model by default.
langchain4j.openai.chat-model.model-name=gpt-5-mini
openai.model.moe=gpt-5-chat-latest
# Define a default API chat model for all components.  This property is read by LangChain4jBeans and fallback mechanisms.
openai.api.model.default=gpt-5-mini
router.moe.threshold=0.62
router.moe.margin=0.08
router.moe.relief.enabled=true
router.moe.relief.threshold-tokens=12000
router.moe.relief.model=gpt-5-mini
router.allow-header-override=false
# base ??? ?? langchain4j.openai.chat-model.model-name ??

############################################################
# 4. ?? ?? ??
############################################################
# ?????? ?? ?? ??
logging.level.com.example.lms=DEBUG
logging.level.com.example.lms.api.ChatApiController=DEBUG
logging.level.com.example.lms.service=DEBUG
logging.level.com.example.lms.service.MemoryReinforcementService=TRACE
logging.level.com.example.lms.repository.TranslationMemoryRepository=DEBUG
logging.level.com.example.lms.service.reinforcement=TRACE
logging.level.com.example.lms.service.NaverSearchService=INFO
logging.level.com.example.lms.service.rag=INFO

# ?????/????? ?? ??
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.web.reactive.function.client.ExchangeFunctions=DEBUG
logging.level.reactor.netty=DEBUG
logging.level.reactor.netty.http.client=DEBUG
logging.level.reactor.netty.http.server=DEBUG
logging.level.com.zaxxer.hikari=DEBUG
logging.level.com.zaxxer.hikari.HikariConfig=DEBUG
logging.level.org.mariadb.jdbc=DEBUG
logging.level.org.hibernate.SQL=INFO
logging.level.org.hibernate.orm.jdbc.bind=INFO
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=DEBUG

logging.level.org.hibernate.stat=DEBUG
logging.level.dev.langchain4j=DEBUG

management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always
management.endpoint.env.show-values=ALWAYS
management.endpoint.logfile.enabled=true
management.server.port=8081


############################################################
# 5. ?? & SSL
############################################################
server.port=80
server.ssl.enabled=true
server.ssl.key-store=classpath:keystore.p12
server.ssl.key-store-password=${SERVER_SSL_KEY_STORE_PASSWORD}
server.ssl.key-store-type=PKCS12
server.ssl.key-alias=myalias
server.ssl.key-password=${SERVER_SSL_KEY_PASSWORD}
server.ssl.protocol=TLS
server.ssl.port=443

############################################################
# 6. ?? (MVC / WebFlux / Netty)
############################################################
spring.mvc.async.request-timeout=180000
spring.webflux.async.request-timeout=180000
spring.reactor.netty.http.client.connect-timeout=60000
spring.reactor.netty.http.client.response-timeout=180s
spring.reactor.netty.http.client.wiretap=true
openai.chat.model.moe=${openai.model.moe:${langchain4j.openai.chat-model.model-name:gpt-5-mini}}
############################################################
# 7. ??? ?? (Thymeleaf)
############################################################
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.cache=false
# true? mini? ??? temperature(?: 0.7)? ? ??? ?? ??? MOE? ?? ??
router.moe.escalate-on-rigid-temp=true

############################################################
# 13. Smart fallback (UX for "?? ??")
############################################################
fallback.enabled=true
fallback.model=gpt-5-mini
fallback.temperature=0.2
fallback.top-p=0.7
fallback.max-tokens=280
# Strategy selection (Softmax/Boltzmann)
strategy.selector.temperature=1.0
strategy.selector.fallback.epsilon=0.10
# StrategyWeightTuner? ???(learning rate) ? ?? ?? ??(h)
tuning.strategy.lr=0.05
tuning.strategy.h=0.02
# ?? ???(wSr, wRw)? ?? ???
strategy.weight.success_rate=0.65
strategy.weight.reward=0.30
# Retrieval fusion
retrieval.fusion.mode=rrf          # rrf | softmax
retrieval.fusion.softmax.temperature=1.0
# =======================================
# Retrieval & ML Correction Settings
# =======================================
# ?? ?? ?? ? ?? ??? ??
retrieval.rank.use-ml-correction=true

# ML ?? ????
ml.correction.alpha=0.0
ml.correction.beta=0.0
ml.correction.gamma=0.0
ml.correction.d0=1.0
ml.correction.mu=0.5
ml.correction.lambda=1.0


############################################################
# 8. ?? API ?/??
############################################################
# 8-1. Kakao
kakao.api.base-url=https://kapi.kakao.com
kakao.api.send-friends-message-path=/v1/api/talk/friends/message/default/send
kakao.api.send-memo-path=/v2/api/talk/memo/default/send
kakao.webclient.connect-timeout-ms=5000
kakao.webclient.read-timeout-ms=10000
kakao.native-app-key=dbfbc3b8d50d512fdf3b449bff26aea2
kakao.rest-api-key=a4b3aed769ef37f30d16b41ba2c6d85a
kakao.javascript-key=0cb92aa95103e345e08a7c2248317495
kakao.admin-key=d6ec26c26e416641c3a9bc582967f221
kakao.client-id=a4b3aed769ef37f30d16b41ba2c6d85a
kakao.redirect-uri=http://abandonwareai.kro.kr/kakao/oauth/callback
kakao.scope=scope=talk_message

# 8-2. Google
google.cloud.project-id=lms-demo-999999
google.translate.keys=AIzaSyA6AF9kdIBQbaMHoEqqgWFuRgFOSaqysAY

# 8-3. OpenAI
openai.api.url=https://api.openai.com/v1
openai.api.key=${OPENAI_API_KEY}
# Ensure that the OpenAI Image API reuses the same API key as the primary
# OpenAI chat/completions API.  Without this explicit property Spring may
# resolve the image key from unrelated environment variables (e.g. GROQ)
# leading to authentication failures.
openai.image.api-key=${OPENAI_API_KEY}
openai.api.history.max-messages=6


abandonware.reranker.backend: embedding-model
# 8-5. Pinecone
pinecone.api.key=${PINECONE_API_KEY}
pinecone.environment=aped-4627-b74a
pinecone.project.id=41f2237d-e960-4fd1-90e0-d39c24a5ccaa
pinecone.index.name=brilliant-aspen
pinecone.embedding-model=text-embedding-3-small

query-hygiene:
typo-map:
??: ??
"??": "??"
"???": "???"
############################################################
# 9. LangChain4j & Chat ??
############################################################
#
# Disabled langchain4j OpenAI auto-configuration.  Manual builders are used instead.
#langchain4j.openai.api-key=${openai.api.key}
#langchain4j.openai.chat-model.api-key=${openai.api.key}

#langchain4j.openai.chat-model.temperature=0.7
#langchain4j.openai.chat-model.timeout=PT180S
#langchain4j.openai.chat-model.log-requests=true
#langchain4j.openai.chat-model.log-responses=true
#langchain4j.openai.chat-model.parallel-tool-calls=false

openai.chat.history.max-messages=10
gpt.system.prompt=You are a helpful assistant for Java developers. Your answers should be concise, clear, and include code examples when possible. Your name is 'LMS-Bot'.


############################################################
# 10. Netty
############################################################
netty.port=9092
netty.boss-threads=1
netty.worker-threads=4
netty.allow-custom-ping=true
# Override the default chat model without referencing the LangChain4j property.
#openai.chat.model.default=${openai.model.moe:${langchain4j.openai.chat-model.model-name:gpt-5-mini}}

############################################################
# 11. Naver Search Tuning & RAG Hybrid
############################################################
# Naver API & ?? ?? ??
naver.keys=jJZeRM6hBi0HbpuMOV0g:NT9neah9Jy
naver.search.web-top-k=5
naver.search.display=40
naver.search.cache.max-size=2000
naver.search.cache.ttl-sec=600
naver.reinforce-assistant=false
naver.reinforce-assistant.weight=0.4
naver.hedge.enabled=true
naver.hedge.delay-ms=150
naver.hedge.timeout-ms=1000

# --- Naver Search & Filter Settings ---
# ?? ?? ??
naver.search.timeout-ms=2500

naver.search.rag-top-k=5

naver.search.debug-json=true

# AuthorityScorer weights (0.0~1.0) - merged
search.authority.weights.official=go.kr:1.0,ac.kr:0.98,genshin.hoyoverse.com:1.0,hoyoverse.com:1.0,hoyolab.com:1.0,reuters.com:0.95,apnews.com:0.95,bbc.com:0.95
search.authority.weights.wiki=wikipedia.org:0.90,namu.wiki:0.75
search.authority.weights.community=fandom.com:0.50,arca.live:0.20,dcinside.com:0.15
search.authority.weights.blog=blog.naver.com:0.55,tistory.com:0.55
blocked-domains: blog.messenger1004.com,messenger1004.com,muscle1004.com,hermes10901.com
query-sim-threshold: 0.6   # ?? ??? ???? ?? ??? ?? ??
# Self-Ask Retriever ?? (API ??? ??)
selfask.max-depth=2
selfask.max-api-calls-per-query=8
selfask.followups-per-level=2
selfask.first-hit-stop-threshold=3

# RAG ????? ?? ???
rag.search.top-k=16
# ? Rerank?? ??? ??
rerank.ce.topK=12
rag.hybrid.weight.vector=0.6
rag.hybrid.weight.keyword=0.4
rag.hybrid.dedup-distance=0.88

# ???/??? ??? ??
# =======================================
# Query Correction Settings
# =======================================
# ???? ??/?? ?? ?? ??? ??
query.correction.enabled=true

# ??? ??? LLM ?? ?? (??? ?? ?? ??)
query.correction.model=gpt-5-mini
ner.model=gpt-5-mini

# ??? ??? ?? ?? ?? (??????? ??????? ????)
query.correction.max-length=140
# =================================================
# Memory Reinforcement - Pruning Settings
# =================================================
naver.search.expansion-policy=none
# =======================================

# ???(?? ??) ?? ??? ??
memory.reinforce.pruning.enabled=true

# ??? ? ??? ???? ?? ?? ??? ??? ???
memory.reinforce.pruning.sentence-sim-threshold=0.6

# ?? ? ??? ? ?? ?? ?? (? ? ???? ?? ??)
memory.reinforce.pruning.min-sentences=1
naver.filters.domain-allowlist=go.kr,ac.kr,hoyoverse.com,hoyolab.com
naver.filters.domain-allowlist.tier.core=wikipedia.org,wikidata.org,wiktionary.org,arxiv.org,pubmed.ncbi.nlm.nih.gov,scholar.google.com,ourworldindata.org,developer.mozilla.org,openjdk.org,docs.oracle.com,docs.gradle.org,maven.apache.org,javadoc.io,langchain4j.dev,platform.openai.com,openai.com,docs.spring.io,spring.io,projectreactor.io,micrometer.io,springdoc.org,swagger.io,openapis.org,quartz-scheduler.org,flywaydb.org,liquibase.org,learn.microsoft.com,docs.aws.amazon.com,cloud.google.com,kubernetes.io,helm.sh,istio.io,envoyproxy.io,opentelemetry.io,prometheus.io,grafana.com,docker.com,containerd.io,cri-o.io,postgresql.org,dev.mysql.com,mariadb.org,redis.io,mongodb.com,clickhouse.com,apache.org,nginx.org,kafka.apache.org,rabbitmq.com,elasticsearch.org,elastic.co,junit.org,testcontainers.org,hibernate.org,mybatis.org,slf4j.org,logback.qos.ch,nodejs.org,npmjs.com,python.org,pypi.org,pip.pypa.io,go.dev,rust-lang.org,protobuf.dev,grpc.io
naver.filters.domain-allowlist.tier.gov_academic=go.kr,ac.kr,or.kr,re.kr,edu,ac.jp,ac.uk,edu.au,edu.sg,edu.hk,edu.tw,edu.cn,gov,gov.uk,gc.ca,europa.eu
naver.filters.domain-allowlist.health=kdca.go.kr,mohw.go.kr,mfds.go.kr,hira.or.hira.or.kr,nhis.or.kr,who.int,nih.gov,ncbi.nlm.nih.gov,cdc.gov,ecdc.europa.eu,medlineplus.gov,clinicaltrials.gov,cochranelibrary.com,mayoclinic.org,nejm.org,thelancet.com,bmj.com
naver.filters.domain-allowlist.tier.blogs=tistory.com,brunch.co.kr,post.naver.com,blog.naver.com,cafe.naver.com,blog.daum.net,velog.io,dev.to,hashnode.com,zenn.dev,qiita.com,medium.com,wordpress.com,blogspot.com,engineering.linecorp.com,tech.kakao.com,d2.naver.com,techblog.woowahan.com,woowabros.github.io,spoqa.github.io
naver.filters.domain-allowlist.tier.game=fandom.com,game8.co,gamewith.jp,liquipedia.net,bulbagarden.net,inven.co.kr,namu.wiki,reddit.com,redd.it,wowhead.com,icy-veins.com,mobalytics.gg,op.gg,u.gg,probuilds.net,gamepress.gg,pcgamer.com,ign.com
naver.filters.domain-allowlist.tier.news=yna.co.kr,koreaherald.com,koreatimes.co.kr,hani.co.kr,joongang.co.kr,chosun.com,mk.co.kr,zdnet.co.kr,etnews.com,inews24.com,ytn.co.kr,sbs.co.kr,kbs.co.kr,mbc.co.kr,jtbc.co.kr,news.naver.com,news.kakao.com,reuters.com,apnews.com,bbc.com,bloomberg.com,theguardian.com,nytimes.com,washingtonpost.com,cnn.com,ft.com,techcrunch.com,theverge.com,arstechnica.com,wired.com,engadget.com
naver.filters.domain-allowlist.tier.market=bunjang.co.kr,daangn.com,joongna.com,hellomarket.com
naver.filters.domain-allowlist.tier.science_publishers=nature.com,science.org,cell.com,sciencedirect.com,link.springer.com,springer.com,onlinelibrary.wiley.com,tandfonline.com,ieee.org,ieeexplore.ieee.org,dl.acm.org
naver.filters.domain-allowlist.tier.data_stats=data.go.kr,kosis.kr,index.go.kr,mdis.kostat.go.kr,data.gov,data.gov.uk,data.europa.eu,oecd.org,worldbank.org,imf.org,un.org,undp.org
naver.filters.domain-allowlist.tier.law_regs=law.go.kr,moj.go.kr,courts.go.kr,pps.go.kr
naver.filters.domain-allowlist.tier.video=youtube.com,youtu.be,vimeo.com
naver.filters.keyword-min-hits=1
naver.search.debug=true
# ?? ?? ??? ???? (?? ? ?? ??)
# filters.domain_filter.enabled=true
# filters.keyword_filter.use_similarity=true
# filters.keyword_filter.min_matches=1
# filters.keyword_filter.levenshtein-max=2
# filters.heuristics.min_short_length=25
# filters.heuristics.max_short_length=350
# filters.heuristics.hyperlink_ratio_threshold=0.35
# filters.heuristics.detect_repeated_punct=true
# filters.heuristics.detect_text_speak=true
# filters.heuristics.detect_contact=true
# filters.fail_safe.take-first-n=8


############################################################
# 12. ?? ?????? ??
############################################################
spring.resources.static-locations=classpath:/static/
pki.validation.upload-dir=./pki-validation
indexing.cron=0 */30 * * * *


############################################################
# 14. Meta-Learning & Strategy (Selector / Perf / Fusion)
############################################################
# ?? ?? ?? ??
strategy.meta.enabled=true
# ?? ????(?? ??? ?? ? ??)
strategy.default.category=default

# ?? ?? ??/?? ?? (Epsilon-Greedy or ?? ??? ??)
strategy.selector.explore-rate=0.10
# ?/?? ?? ?? ? ?? ?? ?? (rrf | borda)
strategy.selector.fusion=rrf

# ??? ??? ?? & ???(?? ?????? ???)
retrieval.mode=RETRIEVAL_ON # RETRIEVAL_ON | RAG_ONLY | RETRIEVAL_OFF
retrieval.reranker=cross # simple | cross


############################################################
# 15. ContextualScorer (Factuality/Quality/Novelty ??)
############################################################
scoring.contextual.enabled=true
scoring.contextual.weights.factuality=0.50
scoring.contextual.weights.quality=0.35
scoring.contextual.weights.novelty=0.15
# ??? ?? ? ?? ???? ???? ? ?? ??? ???? OK
scoring.contextual.min-grounding-lines=2
# ?? ????(??/?? ?? ???) ??
scoring.contextual.quality.apology-penalty=0.20


############################################################
# 16. Reinforcement blending (TM ?? = ML?? ? (1-?) + Contextual ? ?)
############################################################
memory.reinforce.blend.contextual-alpha=0.50
# ??? ?? ?? ??? ?? (?? ??? ????? ?? ?? ?? ???)
memory.reinforce.fallback.positive-bonus=0.10


############################################################
# 17. Dynamic Hyperparameter Tuner
############################################################
tuner.enabled=true
# ?? ?? (?? 00:05) ? ?? ? ??
tuner.cron=0 5 0 * * *
# ?? ??/??? ???(??? ? ?? ???? ??)
tuner.explore.rate.min=0.05
tuner.explore.rate.max=0.30
tuner.threshold.base.min=0.75
tuner.threshold.base.max=0.90
#
# NOTE: ?Ultra Debug? ??? ??? ? application-ultra.properties ? ??
# ?? ??(?: org.mariadb.jdbc=DEBUG, org.hibernate.SQL=INFO ?)? ??
# ?? ?: --spring.profiles.active=ultra



# ??????? ???(HP ??? ?? ?? ??; DB ?? ?? ? ??)
# (??) ?????: ?? ?? API? ? ?? ON
logging.admin.enabled=false
bandit.explore.rate=0.10
bandit.threshold.base=0.85
#Ultra ????Ultra ???? ???? ??? ??? ??.

############################################################
# 18. Logging for new modules
############################################################
logging.level.com.example.lms.strategy=DEBUG
logging.level.com.example.lms.scoring=DEBUG
logging.level.com.example.lms.tuning=INFO


# ????? httptrace(????? ??/Bean ?? ? ??)
management.endpoint.httptrace.enabled=true


# ?????? ??? ?? TRACE(?? ? ?? ??)
# logging.level.com.example.lms=TRACE
# logging.level.com.example.lms.service.NaverSearchService=TRACE
# logging.level.com.example.lms.service.rag=TRACE
# logging.level.com.example.lms.service.reinforcement=TRACE
# logging.level.com.example.lms.repository.TranslationMemoryRepository=TRACE
# logging.level.com.example.lms.strategy=TRACE
# logging.level.com.example.lms.scoring=TRACE
# logging.level.com.example.lms.tuning=TRACE
search.budget.per-page-ms=3500

# -----------------------------------------------------------------------------
# File upload settings

# Directory on the local filesystem where general attachments are saved.  The
# directory is created on demand if it does not exist.  On production this
# should be set to an absolute path via an environment-specific property file.
lms.upload-dir=uploads

# Public URL prefix that maps to the upload directory.  This prefix is used
# by the WebConfig to expose files under /uploads/**.  A trailing slash is
# automatically appended when missing.
lms.upload-public-prefix=/uploads/

# Multipart upload limits.  Increase these values to allow larger files.
spring.servlet.multipart.max-file-size=25MB
spring.servlet.multipart.max-request-size=25MB

# -----------------------------------------------------------------------------
# LLM Routing defaults and API key injection
#
# The following properties define the default and high‑tier chat models for
# LangChain4j.  By explicitly setting these values we avoid unexpected
# inheritance from other properties and ensure the router always has a valid
# fallback.  Additional aliases are provided for ease of reference in the
# ModelRouter and ChatService.  The API key resolution prefers the
# `openai.api.key` property and falls back to the environment variables
# OPENAI_API_KEY or GROQ_API_KEY when not specified.
openai.chat.model.default=${openai.api.model.default}

router.moe.mini=${openai.chat.model.default}
router.moe.high=${openai.chat.model.moe}
app.ai.default-model=${openai.chat.model.default}



# Debug/trace gating (added by patch)
lms.trace.enabled=true
lms.trace.sample=0.1
lms.trace.http.enabled=false
lms.debug.enabled=false
lms.debug.mask-secrets=true
lms.debug.max-bytes=8192

# Debug logger flags (adjusted)
lms.debug.prompts.dump=false
lms.debug.responses.dump=false


# --- SRC91 PATCH BEGIN ---
spring.config.import=optional:file:./application-secrets.yml
# --- SRC91 PATCH END ---
# [patch] Default image plugin settings to prevent boot failures when not configured
openai.image.enabled=false
openai.image.endpoint=/v1/images

# --- auto-patch settings ---
onnx.enabled=true
onnx.max-concurrency=3
budget.request-time-ms=3500
naver.hedge.delay-ms=120
naver.search.timeout-ms=1200
naver.search.web-top-k=12
ocr.enabled=true
ocr.min-confidence=0.78
